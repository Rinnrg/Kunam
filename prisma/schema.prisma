generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Admin {
  id        String   @id
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model carts {
  id        Int      @id @default(autoincrement())
  userId    Int
  produkId  String
  quantity  Int      @default(1)
  ukuran    String?
  warna     String?
  createdAt DateTime @default(now())
  updatedAt DateTime
  produk    produk   @relation(fields: [produkId], references: [id], onDelete: Cascade)
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, produkId, ukuran, warna])
  @@index([produkId])
  @@index([userId])
}

model order_items {
  id       Int     @id @default(autoincrement())
  orderId  Int
  produkId String
  quantity Int
  price    Float
  ukuran   String?
  warna    String?
  orders   orders  @relation(fields: [orderId], references: [id], onDelete: Cascade)
  produk   produk  @relation(fields: [produkId], references: [id], onDelete: Cascade)

  @@index([orderId])
  @@index([produkId])
}

model orders {
  id          Int           @id @default(autoincrement())
  userId      Int
  orderNumber String        @unique
  status      String        @default("pending")
  totalAmount Float
  createdAt   DateTime      @default(now())
  updatedAt   DateTime
  order_items order_items[]
  users       users         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([orderNumber])
  @@index([status])
  @@index([userId])
}

model produk {
  id             String        @id
  nama           String
  kategori       String
  harga          Float
  diskon         Float         @default(0)
  stok           Int           @default(0)
  deskripsi      String?
  ukuran         String[]
  warna          String[]
  gambar         String[]
  video          String[]
  produkUnggulan Boolean       @default(false)
  urutanTampilan Int           @default(0)
  tanggalDibuat  DateTime      @default(now())
  tanggalDiubah  DateTime
  jumlahTerjual  Int           @default(0)
  carts          carts[]
  order_items    order_items[]
  reviews        reviews[]
  wishlists      wishlists[]

  @@index([diskon])
  @@index([jumlahTerjual])
  @@index([kategori])
  @@index([produkUnggulan])
  @@index([urutanTampilan])
}

model reviews {
  id        Int      @id @default(autoincrement())
  userId    Int
  produkId  String
  rating    Int
  comment   String
  createdAt DateTime @default(now())
  updatedAt DateTime
  produk    produk   @relation(fields: [produkId], references: [id], onDelete: Cascade)
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, produkId])
  @@index([produkId])
  @@index([userId])
}

model users {
  id         Int         @id @default(autoincrement())
  email      String      @unique
  password   String?
  name       String?
  phone      String?
  image      String?
  provider   String      @default("credentials")
  providerId String?
  createdAt  DateTime    @default(now())
  updatedAt  DateTime
  carts      carts[]
  orders     orders[]
  reviews    reviews[]
  wishlists  wishlists[]

  @@index([email])
}

model wishlists {
  id        Int      @id @default(autoincrement())
  userId    Int
  produkId  String
  createdAt DateTime @default(now())
  produk    produk   @relation(fields: [produkId], references: [id], onDelete: Cascade)
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, produkId])
  @@index([produkId])
  @@index([userId])
}
